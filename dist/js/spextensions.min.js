var SPExt=SPExt||{};SPExt.ClientTemplates=SPExt.ClientTemplates||{},SPExt.ClientTemplates.DefaultFieldWithValidationTemplate=function(e,t){var r=SPClientTemplates.Utility.GetFormContextForCurrentField(e),i=new SPClientForms.ClientValidation.ValidatorSet;i.RegisterValidator(t),r.registerClientValidator(r.fieldName,i);var l=e.CurrentFieldSchema.FieldType,a=SPClientTemplates._defaultTemplates.Fields["default"].all.all;return a[l][e.BaseViewID](e)},SPExt.ClientTemplates.PrefilledUserFieldTemplate=function(e,t,r){t||$.when(SPExt.User.GetSelfProfile(null,null,!1)).then(function(e){t={AccountName:e.d.DisplayName,DisplayName:e.d.AccountName}});var i=t.AccountName,l="i:0#.w|"+i,a={Description:l,DisplayText:t.DisplayName,EntityType:"User",IsResolved:!0,HierarchyIdentifier:null,Key:l,MultipleMatches:[],ProviderDisplayName:"Active Directory",ProviderName:"AD",EntityData:{Title:"",MobilePhone:"",SIPAddress:"",Department:"",Email:""},AutoFillKey:l,AutoFillDisplayText:i,AutoFillSubDisplayText:"",AutoFillTitleText:"ActiveDirectory\\n"+i,DomainText:"ASBNET",LocalSearchTerm:t.DisplayName,Resolved:!0};if(e.CurrentFieldValue=[],e.CurrentFieldValue.push(a),r){var n=(e.CurrentFieldSchema.Name,SPClientTemplates.Utility.GetFormContextForCurrentField(e)),o=String.format("{0}_{1}_${2}Field",n.fieldSchema.Name,n.fieldSchema.Id,n.fieldSchema.FieldType),s=e.CurrentFieldValue.slice();return n.registerGetValueCallback(e.CurrentFieldSchema.Name,function(){return JSON.stringify(s)}),"<span id='"+o+"'>"+t.DisplayName+"</span>"}return SPClientPeoplePickerCSRTemplate(e)};var SPExt=SPExt||{};SPExt.CSR=SPExt.CSR||{},SPExt.CSR.RegisterTemplateOverride=function(e){SPClientTemplates.TemplateManager.RegisterTemplateOverrides(e)},SPExt.CSR.MdsRegisterTemplateOverride=function(e,t){"[object Array]"!==Object.prototype.toString.call(t)&&(t=[].concat(t));var r=filesNames.shift();null!=r&&(r=SPClientTemplates.Utility.ReplaceUrlTokens(r),RegisterModuleInit(r,function(){t.length>0?SPExt.CSR.MdsRegisterTemplateOverride(e,t):SPExt.CSR.RegisterTemplateOverride(e)}))},SPExt.CSR.Register=function(e,t){"undefined"!=typeof _spPageContextInfo&&null!=_spPageContextInfo?SPExt.CSR.MdsRegisterTemplateOverride(e,t):SPExt.CSR.RegisterTemplateOverride(e)};var SPExt=SPExt||{};SPExt.Forms=SPExt.Forms||{},SPExt.Forms.RenderCustom=function(e,t,r){var i={ListSchema:WPQ2FormCtx.ListSchema,FormUniqueId:e.FormUniqueId,ListId:e.FormContext.listAttributes.Id,ControlMode:e.ControlMode};$.views.helpers({encodeLinkBreaks:function(e){return e.replace(/(?:\r\n|\r|\n)/g,"<br />")}});var l=$("tr > td > span#"+e.FormUniqueId+e.FormContext.listAttributes.Id+e.ListSchema.Field[0].Name),a=$("#WebPart"+e.FormUniqueId+" .ms-formtable"),n=$("<div />",{id:"ClientForm"+e.FormUniqueId});n.insertBefore(a);var o=$.link[r](n,i);return a.remove(),$("tr > td > span#"+e.FormUniqueId+e.FormContext.listAttributes.Id+e.ListSchema.Field[0].Name).replaceWith(l),{renderCtx:i,tmpl:o}};var SPExt=SPExt||{};SPExt.LoadCss=function(e){e=SPClientTemplates.Utility.ReplaceUrlTokens(e);var t=document.createElement("link");t.href=e,t.rel="stylesheet",document.getElementsByTagName("head")[0].appendChild(t)},SPExt.OpenInDialog=function(e){var t={url:e,allowMaximize:!0,showClose:!0};SP.SOD.execute("sp.ui.dialog.js","SP.UI.ModalDialog.showModalDialog",t)},SPExt.CreateGUID=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},SPExt.GetFormTable=function(){return $("#part1 .ms-formtable")};var SPExt=SPExt||{};SPExt.Templates=SPExt.Templates||{},SPExt.Templates.RegisterAll=function(e){e=SPClientTemplates.Utility.ReplaceUrlTokens(e),$.ajax({url:e,async:!1,success:function(e){$(e).each(function(e,t){t.id&&$.templates(t.id,$(t).text())})}})},SPExt.Templates.Register=function(e,t){e=SPClientTemplates.Utility.ReplaceUrlTokens(e),$.ajax({url:e,async:!1,success:function(e){$.templates(t,e)}})};var SPExt=SPExt||{};SPExt.User=SPExt.User||{};var userProfilePromise;SPExt.User.GetSelfProfile=function(e,t,r){return userProfilePromise?userProfilePromise:(t=t||"",e=e||_spPageContextInfo.webServerRelativeUrl,userProfilePromise=$.ajax({async:r,url:e+"/_api/SP.UserProfiles.PeopleManager/GetMyProperties"+t,headers:{Accept:"application/json; odata=verbose"}}))},SPExt.User.GetProperty=function(e,t){for(var r=0;r<t.results.length;r++){var i=t.results[r];if(i.Key==e)return i.Value}},SPExt.User.GetFullAddress=function(){return $.Deferred(function(e){SPExt.User.GetSelfProfile().then(function(t){var r=SPExt.User.GetProperty("streetAddress",t.d.UserProfileProperties),i=SPExt.User.GetProperty("postalCode",t.d.UserProfileProperties),l=SPExt.User.GetProperty("SPS-Location",t.d.UserProfileProperties);if(null!=r&&""!=r&&null!=i&&""!=i&&null!=l&&""!=l){var a=r+"\n"+i+"-"+l;return e.resolve(a)}return e.reject("Empty user address")},e.reject)}).promise()};var SPExt=SPExt||{};SPExt.Validation=SPExt.Validation||{},SPExt.Validation.NotNullValidator=function(){},SPExt.Validation.NotNullValidator.prototype.Validate=function(e){var t=null==e||""==e,r=t?"Der Wert darf nicht leer gelassen werden.":"";return new SPClientForms.ClientValidation.ValidationResult(t,r)};